---
title: "Grupo 1"
author: "William Aponte, María Betina Berardi, Gilberto Robinson Cetre Palacio, Alejandra María Esteban, Claudia Zárate, Emiliano Tobares"
date: "11/12/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
rm(list=ls())
getwd()
```

## Creación los vectores de coordenadas x, y además del vector w de pesos

```{r}
x<-c(98,202,113,99,111)

y<-c(728,423,592,330,46)

w<-c(1,1,1,1,1)

ciudades<- c("Arica", "Calama", "Iquique", "Antofagasta", "Copiapó")

```

## Planteo del Problema

Se busca emplazar la sucursal de una empresa de servicios cuyos clientes son centros médicos y hospitales. Actualmente, la sede principal está en Santiago de Chile pero semanalmente hay que hacer varios viajes en avión a las ciudades del norte.

## Modelo de localización plana

## Modelo ORLOca - Operations Research LOCational Analysis Models

Calcula la mínima suma ponderada de las distancias a los puntos de demanda, se basa en el problema presentado por Fermat-Weber
Introducción a la ubicación plana con orloca
Manuel Muñoz-Márquez, 1
El paquete RcmdrPlugin.orloca dedicado a resolver el problema de ubicación continua plana, ha sido desarrollado para R como software gratuito.
Está destinado a ser utilizado como una manera fácil de presentar a los estudiantes los problemas de ubicación de puntos planos. Esto se hace proporcionando una guía y una aplicación interactiva en línea para manejar y resolver dicho problema.
1. Introducción
Ante un problema de ubicación, buscamos la ubicación óptima de un servicio. Ejemplos de los problemas de localización son: encontrar la ubicación óptima del almacén central o una ambulancia que deba atender a los pacientes.
El paquete resuelve el problema de ubicar un solo punto en el plano, minimizando la suma de las distancias ponderadas a los puntos de demanda.
2. Características del paquete
Se ha definido una nueva clase de objetos, designada como loca.p, para manejar instancias del problema.
Desde el menú se pueden crear nuevas instancias de objetos loca.p, generar nuevas instancias aleatorias y hacer resúmenes de los datos. También se puede evaluar la distancia media ponderada, en el siguiente distsum y calcular la pendiente de la misma.
También hay una opción para encontrar el mínimo de distsum usando el algoritmo de Weiszfeld, [2] ; [3], o una optimización global. El algoritmo de Weiszfeld incluye una prueba de optimización para los puntos de demanda. Se han proporcionado cuatro opciones para hacer algunos gráficos, como muestran las figuras. El menú de ayuda proporciona varias opciones para obtener más información sobre el uso del paquete y proporciona varios ejemplos.
![image](https://user-images.githubusercontent.com/95891858/147104999-bdaf240d-7965-465e-9b01-9659083a2854.png)
3 Conclusiones
El paquete RcmdrPlugin.orloca resuelve el problema de ubicación plana de un solo servicio utilizando menús fáciles de usar, por lo que es una buena manera de presentar este problema a los estudiantes. 
4 Referencias
[1] Manuel Munoz-Marquez. A GUI for Planar Location Problems. Cadiz University, 4.6 edition, 2018.
[2] E. Weiszfeld. Sur le point pour lequel la Somme des distances de n points donnés est minimum. Tohoku Mathematical Journal, First Series, 43:355–386, 1937.
[3] E.Weiszfeld and Frank Plastria. On the point for which the sum of the distances to n given points is minimum. Annals of Operations Research, 167(1):7–41, Mar 2009.



```{r}
library(orloca)
loca.p(x, y, w, label= "Chile zona norte")
chile<-loca.p(x, y, w, label = "Chile zona norte")
```

## Resumen numérico del objeto Orloca

```{r}
summary(chile)
```


## Cálculo de las Distancias mínimas

### Solución óptima al problema de localización


```{r}
solucion <- distsummin(chile)
solucion
```
### Solución óptima al problema de localización para el algoritmo gradient

```{r}
solucion1 <- distsummin(chile, Lp= 3,5, algorithm = "gradient" )
solucion1
```

### Solución óptima al problema de localización para el algoritmo ucminf

```{r}
solucion2 <- distsummin(chile, Lp = 2, algorithm = "ucminf" )
solucion2
```
### Solución óptima al problema de localización para el algoritmo Nelder-Mead

```{r}
solucion3 <- distsummin(chile, Lp = 2, algorithm = "Nelder-Mead" )
solucion3

```
### Solución óptima al problema de localización para el algoritmo BFGS

```{r}
solucion4 <- distsummin(chile, Lp = 2, algorithm = "BFGS" )
solucion4
```
### Solución óptima al problema de localización para el algoritmo CG

```{r}
solucion5 <- distsummin(chile, algorithm = "CG" )
solucion5
```

### Solución óptima al problema de localización para el algoritmo L-BFGS-B

```{r}
solucion6 <- distsummin(chile, Lp = 2, algorithm = "L-BFGS-B" )
solucion6
```
### Solución óptima al problema de localización para el algoritmo SANN

```{r}
solucion7 <- distsummin(chile, Lp = 2, algorithm = "SANN" )
solucion7
```




## Distancia media ponderada al punto obtenido

```{r}
distsum(chile, x=solucion[1], y=solucion[2])
distsum(chile, x=solucion1[1], y=solucion1[2])
distsum(chile, x=solucion2[1], y=solucion2[2])
distsum(chile, x=solucion3[1], y=solucion3[2])
distsum(chile, x=solucion4[1], y=solucion4[2])
distsum(chile, x=solucion5[1], y=solucion5[2])
distsum(chile, x=solucion6[1], y=solucion6[2])
distsum(chile, x=solucion7[1], y=solucion7[2])
```
## Dibujo o Ploteo

```{r}
plot(chile, xleft=0, ybottom=0, xright=343, ytop=800)
```


## Gradiente de la distancia media ponderada al punto obtenido

```{r}
distsumgra(chile, x=solucion[1], y=solucion[2] )
```

## Gráfico de curvas de nivel

```{r}
contour(chile, xleft=0, ybottom=0, xright=800, ytop=800)
```

## Zooming

```{r}
contour(chile, xleft=0, ybottom=0, xright=800, ytop=800,levels = c(1080, 1090, 1100, 1150,1200))

```



```{r}
persp(chile)
```



```{r}
persp(chile, col = "lightblue", theta = 45, ltheta = 120, shade = 0.75, ticktype = "detailed")
```


```{r}
chile_map = ("Chile.png")
img = readPNG(chile_map)
plot(chile, img=img, main="Chile", xleft=0, ybottom=0, xright=800, ytop=800)
```

```{r}
contour(chile, img=img, main="Chile zona norte", xleft=0, ybottom=0, xright=800, ytop=800)
```




```{r}
contour(chile, img=img, main="Chile zona norte", xleft=0, ybottom=0, xright=800, ytop=800)
points(solucion[1], solucion[2], type='p', col='red')
```


