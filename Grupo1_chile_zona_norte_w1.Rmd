---
title: "Grupo 1"
author: "William Aponte, María Betina Berardi, Gilberto Robinson Cetre Palacio, Alejandra María Esteban, Claudia Zárate, Emiliano Tobares"
date: "11/12/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
rm(list=ls())
getwd()
```

## Creación los vectores de coordenadas x, y además del vector w de pesos

```{r}
x<-c(98,202,113,99,111)

y<-c(728,423,592,330,46)

w<-c(1,1,1,1,1)

ciudades<- c("Arica", "Calama", "Iquique", "Antofagasta", "Copiapó")

```

## Planteo del Problema

Se busca emplazar la sucursal de una empresa de servicios cuyos clientes son centros médicos y hospitales. Actualmente, la sede principal está en Santiago de Chile pero semanalmente hay que hacer varios viajes en avión a las ciudades del norte.

## Modelo de localización plana

## Modelo ORLOca - Operations Research LOCational Analysis Models

Calcula la mínima suma ponderada de las distancias a los puntos de demanda, se basa en el problema presentado por Fermat-Weber



```{r}
library(orloca)
loca.p(x, y, w, label= "Chile zona norte")
chile<-loca.p(x, y, w, label = "Chile zona norte")
```

## Resumen numérico del objeto Orloca

```{r}
summary(chile)
```


## Cálculo de las Distancias mínimas

### Solución óptima al problema de localización


```{r}
solucion <- distsummin(chile)
solucion
```
### Solución óptima al problema de localización para el algoritmo gradient

```{r}
solucion1 <- distsummin(chile, Lp= 3,5, algorithm = "gradient" )
solucion1
```

### Solución óptima al problema de localización para el algoritmo ucminf

```{r}
solucion2 <- distsummin(chile, Lp = 2, algorithm = "ucminf" )
solucion2
```
### Solución óptima al problema de localización para el algoritmo Nelder-Mead

```{r}
solucion3 <- distsummin(chile, Lp = 2, algorithm = "Nelder-Mead" )
solucion3

```
### Solución óptima al problema de localización para el algoritmo BFGS

```{r}
solucion4 <- distsummin(chile, Lp = 2, algorithm = "BFGS" )
solucion4
```
### Solución óptima al problema de localización para el algoritmo CG

```{r}
solucion5 <- distsummin(chile, algorithm = "CG" )
solucion5
```

### Solución óptima al problema de localización para el algoritmo L-BFGS-B

```{r}
solucion6 <- distsummin(chile, Lp = 2, algorithm = "L-BFGS-B" )
solucion6
```
### Solución óptima al problema de localización para el algoritmo SANN

```{r}
solucion7 <- distsummin(chile, Lp = 2, algorithm = "SANN" )
solucion7
```




## Distancia media ponderada al punto obtenido

```{r}
distsum(chile, x=solucion[1], y=solucion[2])
distsum(chile, x=solucion1[1], y=solucion1[2])
distsum(chile, x=solucion2[1], y=solucion2[2])
distsum(chile, x=solucion3[1], y=solucion3[2])
distsum(chile, x=solucion4[1], y=solucion4[2])
distsum(chile, x=solucion5[1], y=solucion5[2])
distsum(chile, x=solucion6[1], y=solucion6[2])
distsum(chile, x=solucion7[1], y=solucion7[2])
```
## Dibujo o Ploteo

```{r}
plot(chile, xleft=0, ybottom=0, xright=343, ytop=800)
```


## Gradiente de la distancia media ponderada al punto obtenido

```{r}
distsumgra(chile, x=solucion[1], y=solucion[2] )
```

## Gráfico de curvas de nivel

```{r}
contour(chile, xleft=0, ybottom=0, xright=800, ytop=800)
```

## Zooming

```{r}
contour(chile, xleft=0, ybottom=0, xright=800, ytop=800,levels = c(1080, 1090, 1100, 1150,1200))

```



```{r}
persp(chile)
```



```{r}
persp(chile, col = "lightblue", theta = 45, ltheta = 120, shade = 0.75, ticktype = "detailed")
```


```{r}
chile_map = ("Chile.png")
img = readPNG(chile_map)
plot(chile, img=img, main="Chile", xleft=0, ybottom=0, xright=800, ytop=800)
```

```{r}
contour(chile, img=img, main="Chile zona norte", xleft=0, ybottom=0, xright=800, ytop=800)
```




```{r}
contour(chile, img=img, main="Chile zona norte", xleft=0, ybottom=0, xright=800, ytop=800)
points(solucion[1], solucion[2], type='p', col='red')
```


